file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
library(flowCore)
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
library(flowCore)
library(ggcyto)
library(ggpubr)
library(Biobase)
library(ggplot2)
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
head(dataset1)
summary(dataset1)
detach("package:flowCore", unload = TRUE)
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
head(dataset1)
summary(dataset1)
detach("package:flowWorkspace", unload = TRUE)
detach("package:datasets", unload = TRUE)
detach("package:BH", unload = TRUE)
detach("package:Biobase", unload = TRUE)
detach("package:BiocGenerics", unload = TRUE)
detach("package:ggcyto", unload = TRUE)
detach("package:ggplot2", unload = TRUE)
detach("package:ggpubr", unload = TRUE)
detach("package:grDevices", unload = TRUE)
detach("package:graphics", unload = TRUE)
detach("package:methods", unload = TRUE)
detach("package:ncdfFlow", unload = TRUE)
detach("package:RcppArmadillo", unload = TRUE)
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
head(dataset1)
summary(dataset1)
getMethod(read.FCS)
getMethod("read.FCS")
library(flowCore)
getMethod("read.FCS")
View("read.FCS")
library(sgt)
library(flowCore)
view(flowFrame())
View(flowFrame())
View(flowFrame
View(flowFrame)
View(flowFrame)
View(read.FCS)
knitr::opts_chunk$set(echo = TRUE)
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
head(dataset1)
summary(dataset1)
detach("package:flowCore", unload = TRUE)
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
source("read.FSC_copy.r")
source("read.FSC_copy.r")
source("read.FSC_copy.r")
func_x <- source("read.FSC_copy.r")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_x <- source("read.FSC_copy.r")
View(func_x)
View(func_x)
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
library(flowCore)
library(flowCore)
library(flowCore)
read.FCS()
func_x <- source("read.FSC_copy.R")
source("check_channel_alias_copy.R")
func_copy <- source("check_channel_alias_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_x <- source("read.FSC_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_copy_checkchannelalias <- source("check_channel_alias_copy.R")
func_copy_findOffsets <- source("findOffsets_copy.R")
func_copy_checkchannelalias <- source("check_channel_alias_copy.R")
func_copy_findOffsets <- source("findOffsets_copy.R")
func_x <- source("read.FSC_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_copy_readFSCtext <- source("readFCSheader_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_copy_readFSCheader <- source("readFCSheader_copy.R")
func_x <- source("read.FSC_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_copy_readFSCheader <- source("readFCSheader_copy.R")
func_copy_readFSCtext <- source("readFCSheader_copy.R")
func_x <- source("read.FSC_copy.R")
func_x <- source("read.FSC_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_copy_readFSCheader <- source("readFCSheader_copy.R")
func_copy_readFSCtext <- source("readFCSheader_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
func_x <- source("read.FSC_copy.R")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
pack_flowcore <- source("flowCore")
files.source <- list.files("flowCore")
sapply(files.source, source)
install.packages("miceadds")
library(miceadds)
getwd()
source.all(path = "flowcore")
library(miceadds)
getwd()
source.all(path = "flowcore")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- func_x$value(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
library(miceadds)
getwd()
source.all(path = "flowcore")
library(miceadds)
getwd()
source.all(path = "flfowcore")
library(miceadds)
getwd()
source.all(path = "flowCore")
x <- source.all(path = "flowCore")
install.packages("flowCore")
install.packages("flowCore")
install.packages("/Users/pasca/Documents/School/HanzeHogeschool/Programprojects/Minor/bioplastic_degradation/HDBscan/flowCore", repos = NULL, type="source")
install.packages("/Users/pasca/Documents/School/HanzeHogeschool/Programprojects/Minor/bioplastic_degradation/HDBscan/flowCore", repos = NULL, type="source")
exit
knitr::opts_chunk$set(echo = TRUE)
#imports
library(scales)
library(dbscan)
library("fpc")
library("plyr")
library("dplyr")
library("readr")
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
#imports
library(scales)
library(dbscan)
library("fpc")
library("plyr")
library("dplyr")
library("readr")
library(ggplot2)
map3 <- read.csv("data/Sample1_folder2.csv")
db_clustering <- function(file_in, NumOfPts = 20){
# Random samples data if file to big
if (between(nrow(file_in), 10000, 20000)){
file_in <- sample_n(file_in, 15000)
memory.limit(size = 4000)
} else if (nrow(file_in) > 20000){
file_in <- sample_n(file_in, 25000)
memory.limit(size = 4000)
}
# strip all columns except fsc and ssc
modified <- file_in[,c(1,2)]
# if there are NA's, replaces them with the mean
modified[modified == 0] <- NA
for(i in 1:ncol(modified)){
modified[is.na(modified[,i]), i] <- mean(modified[,i], na.rm = TRUE)
}
# log transform file
log_file <- log2(modified)
# Apply Hdbscan on log transformed data
scan <- hdbscan(log_file, NumOfPts)
# plots the data and return scan statistics
plot(log_file, col = scan$cluster +1, pch = 20)
return(scan)
}
points_calc <- function(x){
# calculate number of points with 1.5%
num_of_points <- length(x[,1])/100*1.5
# if data is small, apply smaller number of points
if (length(row(x[1])) > 1000){
return(num_of_points)
} else {
return(15)}}
map3 <- read.csv("../csvData/Sample1_folder2.csv")
map4 <- read.csv("../csvData/csvData2/Sample1/A03_Carl_d10x_S01.fcs.csv")
#Tree_t <- db_clustering(map2, points_calc(map2))
Tree_f <- db_clustering(map2, points_calc(map2))
calc_log <- function(file_in){
modified <- file_in[1:2]
modified[modified == 0] <- NA
for(i in 1:ncol(modified)){
modified[is.na(modified[,i]), i] <- mean(modified[,i], na.rm = TRUE)
}
log_file <- log2(modified)
return(log_file)
}
calc_coords <- function(frame, cluster){
sum_cluster_1_FSC <- sum(frame[frame$cluster == cluster, c(1)])
sum_cluster_1_SSC <- sum(frame[frame$cluster == cluster, c(2)])
total_cluster1_FSC <- length(frame[frame$cluster == cluster, c(1)])
total_cluster1_SSC <- length(frame[frame$cluster == cluster, c(2)])
map3_center_1 <- data.frame(x = sum_cluster_1_FSC / total_cluster1_FSC,
y = sum_cluster_1_SSC / total_cluster1_SSC)
return(map3_center_1)
}
log_map3 <- calc_log(map3)
scan_map3 <- db_clustering(map3, points_calc(map3))
log_map3["cluster"] <- scan_map3$cluster
