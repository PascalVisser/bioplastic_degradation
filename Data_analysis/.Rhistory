knitr::opts_chunk$set(echo = TRUE)
distmat <- dist(dataset1$`FSC-H`, method = "euclidean")
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
library(flowCore)
library(ggcyto)
library(ggpubr)
library(Biobase)
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
head(dataset1)
summary(dataset1)
distmat <- dist(dataset1$`FSC-H`, method = "euclidean")
distmat <- dist(dataset1$`FSC-H`, method = "euclidean")
distmat <- dist(dataset1$`FSC-H`, method = "euclidean")
knitr::opts_chunk$set(echo = TRUE)
file_list4 <- list.files(path="../FACS_Data/PHBV_Micha4/")
dataset4 <- data.frame()
for(i in 1:length(file_list4)){
file_string <- file_list4[i]
file_string <- paste("../FACS_Data/PHBV_Micha4/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset4 <- rbind(dataset4, fcs.data.frame)
}
library(flowCore)
library(ggcyto)
library(ggpubr)
library(Biobase)
file_list1 <- list.files(path="../FACS_Data/PHBV_Micha1/")
dataset1 <- data.frame()
for(i in 1:length(file_list1)){
file_string <- file_list1[i]
file_string <- paste("../FACS_Data/PHBV_Micha1/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset1 <- rbind(dataset1, fcs.data.frame)
}
head(dataset1)
summary(dataset1)
distmat <- dist(dataset1$`FSC-H`, method = "euclidean")
distmat <- dist(dataset1$`FSC-H`, method = "euclidean")
memory.limit()
distmat <- dist(dataset1$`FSC-H`, method = "canberra")
distmat <- dist(dataset1$`FSC-H`)
distmat <- dist(dataset1$`FSC-A`)
plot(dataset1$`FSC-H` ~ dataset1$`SSC-H`)
plot(dataset1$`FSC-H` ~ dataset1$`SSC-H`)
plot(dataset2$`FSC-H` ~ dataset2$`SSC-H`)
file_list2 <- list.files(path="../FACS_Data/PHBV_Micha2/")
dataset2 <- data.frame()
for(i in 1:length(file_list2)){
file_string <- file_list2[i]
file_string <- paste("../FACS_Data/PHBV_Micha2/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset2 <- rbind(dataset2, fcs.data.frame)
}
head(dataset2)
summary(dataset2)
file_list3 <- list.files(path="../FACS_Data/PHBV_Micha3/")
dataset3 <- data.frame()
for(i in 1:length(file_list3)){
file_string <- file_list3[i]
file_string <- paste("../FACS_Data/PHBV_Micha3/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset3 <- rbind(dataset3, fcs.data.frame)
}
head(dataset3)
summary(dataset3)
file_list4 <- list.files(path="../FACS_Data/PHBV_Micha4/")
dataset4 <- data.frame()
for(i in 1:length(file_list4)){
file_string <- file_list4[i]
file_string <- paste("../FACS_Data/PHBV_Micha4/", file_string, sep = "")
fcs.data <- read.FCS(file_string)
fcs.data.frame <- as.data.frame(exprs(fcs.data))
dataset4 <- rbind(dataset4, fcs.data.frame)
}
head(dataset4)
summary(dataset4)
par(mfrow=c(2,2))
plot(dataset1$`FSC-H` ~ dataset1$`SSC-H`)
plot(dataset2$`FSC-H` ~ dataset2$`SSC-H`)
plot(dataset3$`FSC-H` ~ dataset3$`SSC-H`)
plot(dataset4$`FSC-H` ~ dataset4$`SSC-H`)
write.csv(dataset1, file = "./CSVdata/dataset1")
write.csv(dataset1, file = "./CSVdata/dataset1", row.names = FALSE)
write.csv(dataset1, file = "./CSVdata/dataset1", row.names = FALSE)
write.csv(dataset2, file = "./CSVdata/dataset2", row.names = FALSE)
write.csv(dataset3, file = "./CSVdata/dataset3", row.names = FALSE)
write.csv(dataset4, file = "./CSVdata/dataset4", row.names = FALSE)
write.csv(dataset1, file = "./CSVdata/dataset1.csv", row.names = FALSE)
write.csv(dataset2, file = "./CSVdata/dataset2.csv", row.names = FALSE)
write.csv(dataset3, file = "./CSVdata/dataset3.csv", row.names = FALSE)
write.csv(dataset4, file = "./CSVdata/dataset4.csv", row.names = FALSE)
km <- kmeans(dataset1[,c(7:12)], 2)
plot(dataset1$`FSC-H` ~ dataset1$`SSC-H`, col = km)
km <- kmeans(dataset1, 2)
plot(dataset1$`FSC-H`, dataset1$`SSC-H`, col = km)
km <- kmeans(dataset1[,c(7:12)], 2)
plot(dataset1$`FSC-H`, dataset1$`SSC-H`, col = km$cluster)
km <- kmeans(dataset1[,c(7:12)], 3)
plot(dataset1$`FSC-H`, dataset1$`SSC-H`, col = km$cluster)
km <- kmeans(dataset1[,c(7:12)], 2)
plot(dataset1$`FSC-H`, dataset1$`SSC-H`, col = km$cluster)
km <- kmeans(dataset1[,c(1:12)], 2)
plot(dataset1$`FSC-H`, dataset1$`SSC-H`, col = km$cluster)
par(mfrow=c(2,2))
km1 <- kmeans(dataset1[,c(1:12)], 2)
km2 <- kmeans(dataset2[,c(1:12)], 2)
km3 <- kmeans(dataset3[,c(1:12)], 2)
km4 <- kmeans(dataset4[,c(1:12)], 2)
plot(dataset1$`FSC-H` ~ dataset1$`SSC-H`, col = km1$cluster)
plot(dataset2$`FSC-H` ~ dataset2$`SSC-H`, col = km2$cluster)
plot(dataset3$`FSC-H` ~ dataset3$`SSC-H`, col = km3$cluster)
plot(dataset4$`FSC-H` ~ dataset4$`SSC-H`, col = km4$cluster)
par(mfrow=c(2,2))
km1 <- kmeans(dataset1[,c(1:12)], 2)
km2 <- kmeans(dataset2[,c(1:12)], 2)
km3 <- kmeans(dataset3[,c(1:12)], 2)
km4 <- kmeans(dataset4[,c(1:12)], 2)
plot(dataset1$`FSC-H` ~ dataset1$`SSC-H`, col = km1$cluster,
main = "Clustering of dataset 1",
ylab = "Forward scatter H",
xlab = "Sideward scatter H")
plot(dataset2$`FSC-H` ~ dataset2$`SSC-H`, col = km2$cluster,
main = "Clustering of dataset 2",
ylab = "Forward scatter H",
xlab = "Sideward scatter H")
plot(dataset3$`FSC-H` ~ dataset3$`SSC-H`, col = km3$cluster,
main = "Clustering of dataset 3",
ylab = "Forward scatter H",
xlab = "Sideward scatter H")
plot(dataset4$`FSC-H` ~ dataset4$`SSC-H`, col = km4$cluster,
main = "Clustering of dataset 4",
ylab = "Forward scatter H",
xlab = "Sideward scatter H")
par(mfrow=c(2,2))
plot(dataset1$`FSC-A` ~ dataset1$`SSC-A`, col = km1$cluster,
main = "Clustering of dataset 1",
ylab = "Forward scatter A",
xlab = "Sideward scatter A")
plot(dataset2$`FSC-A` ~ dataset2$`SSC-A`, col = km2$cluster,
main = "Clustering of dataset 2",
ylab = "Forward scatter A",
xlab = "Sideward scatter A")
plot(dataset3$`FSC-A` ~ dataset3$`SSC-A`, col = km3$cluster,
main = "Clustering of dataset 3",
ylab = "Forward scatter A",
xlab = "Sideward scatter A")
plot(dataset4$`FSC-A` ~ dataset4$`SSC-A`, col = km4$cluster,
main = "Clustering of dataset 4",
ylab = "Forward scatter A",
xlab = "Sideward scatter A")
km1$centers
km1$centers$SSC-A
km1$centers
km1$centers[2]
km1$centers[,2]
km1$centers
km1$centers[,2]
km1$centers
km1$centers[,2] - km2$centers[,2]
km1$centers[,2] - km2$centers[,2]
